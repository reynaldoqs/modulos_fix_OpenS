{"remainingRequest":"/home/reynaldo/Escritorio/interoparabilidad/interope-cliente/iop-plataforma-frontend/node_modules/babel-loader/lib/index.js!/home/reynaldo/Escritorio/interoparabilidad/interope-cliente/iop-plataforma-frontend/node_modules/eslint-loader/index.js??ref--13-0!/home/reynaldo/Escritorio/interoparabilidad/interope-cliente/iop-plataforma-frontend/src/Usuario/store/modules/auth.js","dependencies":[{"path":"/home/reynaldo/Escritorio/interoparabilidad/interope-cliente/iop-plataforma-frontend/src/Usuario/store/modules/auth.js","mtime":1543864787258},{"path":"/home/reynaldo/Escritorio/interoparabilidad/interope-cliente/iop-plataforma-frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/reynaldo/Escritorio/interoparabilidad/interope-cliente/iop-plataforma-frontend/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/reynaldo/Escritorio/interoparabilidad/interope-cliente/iop-plataforma-frontend/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import _defineProperty from \"/home/reynaldo/Escritorio/interoparabilidad/interope-cliente/iop-plataforma-frontend/node_modules/@babel/runtime/helpers/esm/defineProperty\";\n\nvar _mutations;\n\nimport axios from 'axios';\nimport { AUTH_REQUEST, AUTH_ERROR, AUTH_SUCCESS, AUTH_LOGOUT } from '../actions/auth';\nimport { authApi } from '@/services';\nvar state = {\n  user: JSON.parse(localStorage.getItem('user')) || '',\n  status: '',\n  hasLoadedOnce: false\n};\nvar getters = {\n  isAuthenticated: function isAuthenticated(state) {\n    return !(state.user === '' || state.user === undefined);\n  },\n  authStatus: function authStatus(state) {\n    return state.status;\n  },\n  currentUser: function currentUser(state) {\n    return state.user || 'not found';\n  }\n};\nvar mutations = (_mutations = {}, _defineProperty(_mutations, AUTH_REQUEST, function (state) {\n  state.status = 'loading';\n}), _defineProperty(_mutations, AUTH_SUCCESS, function (state, resp) {\n  state.status = 'success';\n  state.user = resp; // update: Mejorar esta parte\n\n  state.hasLoadedOnce = true;\n}), _defineProperty(_mutations, AUTH_ERROR, function (state) {\n  state.status = 'error';\n  state.hasLoadedOnce = true;\n}), _defineProperty(_mutations, AUTH_LOGOUT, function (state) {\n  state.user = '';\n}), _mutations);\nvar actions = {\n  login: function login(context, creds) {\n    context.commit(AUTH_REQUEST);\n    return new Promise(function (resolve, reject) {\n      authApi.login(creds).then(function (data) {\n        var user = data;\n        localStorage.setItem('user', JSON.stringify(user));\n        axios.defaults.headers.common['Authorization'] = user.accesos.token;\n        context.commit(AUTH_SUCCESS, user);\n        resolve('Login Success');\n      }).catch(function (err) {\n        context.commit(AUTH_ERROR, err);\n        localStorage.clear();\n        reject(err);\n      });\n    });\n  },\n  logout: function logout(context) {\n    // update: retornar un promise para quemar el token en el server\n    localStorage.removeItem('user');\n    localStorage.clear();\n    axios.defaults.headers.common['Authorization'] = '';\n    context.commit(AUTH_LOGOUT);\n  }\n};\nexport default {\n  state: state,\n  getters: getters,\n  actions: actions,\n  mutations: mutations\n};",{"version":3,"sources":["/home/reynaldo/Escritorio/interoparabilidad/interope-cliente/iop-plataforma-frontend/src/Usuario/store/modules/auth.js"],"names":["axios","AUTH_REQUEST","AUTH_ERROR","AUTH_SUCCESS","AUTH_LOGOUT","authApi","state","user","JSON","parse","localStorage","getItem","status","hasLoadedOnce","getters","isAuthenticated","undefined","authStatus","currentUser","mutations","resp","actions","login","context","creds","commit","Promise","resolve","reject","then","data","setItem","stringify","defaults","headers","common","accesos","token","catch","err","clear","logout","removeItem"],"mappings":"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","sourcesContent":["import axios from 'axios'\nimport {\n  AUTH_REQUEST,\n  AUTH_ERROR,\n  AUTH_SUCCESS,\n  AUTH_LOGOUT\n} from '../actions/auth'\nimport { authApi } from '@/services'\n\nconst state = {\n  user: JSON.parse(localStorage.getItem('user')) || '',\n  status: '',\n  hasLoadedOnce: false\n}\n\nconst getters = {\n  isAuthenticated: state => {\n    return !(state.user === '' || state.user === undefined)\n  },\n  authStatus: state => state.status,\n  currentUser: state => state.user || 'not found'\n}\nconst mutations = {\n  [AUTH_REQUEST]: state => {\n    state.status = 'loading'\n  },\n  [AUTH_SUCCESS]: (state, resp) => {\n    state.status = 'success'\n    state.user = resp // update: Mejorar esta parte\n    state.hasLoadedOnce = true\n  },\n  [AUTH_ERROR]: state => {\n    state.status = 'error'\n    state.hasLoadedOnce = true\n  },\n  [AUTH_LOGOUT]: state => {\n    state.user = ''\n  }\n}\n\nconst actions = {\n  login: (context, creds) => {\n    context.commit(AUTH_REQUEST)\n    return new Promise((resolve, reject) => {\n      authApi\n        .login(creds)\n        .then(data => {\n          let user = data\n          localStorage.setItem('user', JSON.stringify(user))\n          axios.defaults.headers.common['Authorization'] = user.accesos.token\n          context.commit(AUTH_SUCCESS, user)\n          resolve('Login Success')\n        })\n        .catch(err => {\n          context.commit(AUTH_ERROR, err)\n          localStorage.clear()\n          reject(err)\n        })\n    })\n  },\n  logout: context => {\n    // update: retornar un promise para quemar el token en el server\n    localStorage.removeItem('user')\n    localStorage.clear()\n    axios.defaults.headers.common['Authorization'] = ''\n    context.commit(AUTH_LOGOUT)\n  }\n}\n\nexport default {\n  state,\n  getters,\n  actions,\n  mutations\n}\n"]}]}